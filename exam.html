<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exam - Examination System</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link rel="stylesheet" href="exam.css" />
  </head>
  <body>
    <header>
      <div class="logo">Examination System</div>
      <nav>
        <a href="index.html">Home</a>
        <a href="start-exam.html" class="startButton">Start</a>
        <button id="darkModeToggle" title="Toggle Dark Mode">
          <i class="fa-solid fa-moon"></i>
        </button>
        <a href="#" id="logout">Logout</a>
      </nav>
    </header>

    <main class="container">
      <!-- Timer section with text -->
      <div class="timer-wrapper">
        <div id="timer-text">Time Left: 5:00</div>
        <div class="timer">
          <div class="time-bar" id="timebar"></div>
        </div>
      </div>

      <!-- Progress Indicator -->
      <div class="progress-indicator">
        <div class="progress-text">Question 1 of 10</div>
        <div class="progress-bar-container">
          <div id="progress-bar"></div>
        </div>
        <div class="answered-count">0/10 Answered</div>
      </div>

      <div class="section-two">
        <!-- question section -->
        <div class="question-section">
          <div class="question">
            <i class="fa-solid fa-star"></i>I wish i .... those words. But now
            it's too late.
          </div>

          <div class="option-section">
            <label for="one">
              not having said <input type="radio" name="option" id="one" />
            </label>
            <label for="two">
              hadn't said <input type="radio" name="option" id="two" />
            </label>
            <label for="three">
              didn't say <input type="radio" name="option" id="three" />
            </label>
            <label for="four">
              haven't said <input type="radio" name="option" id="four" />
            </label>
          </div>

          <div class="nav-button">
            <div class="nextAprev">
              <div class="prev">Previous</div>
              <div class="num">1</div>
              <div class="next">Next</div>
            </div>
            <div class="mark">
              <div class="mark-btn">Bookmark</div>
            </div>
          </div>
        </div>

        <!-- section mark - Question Palette -->
        <div class="section-mark">
          <div style="text-align: center; color: white; font-weight: bold; margin-bottom: 15px; font-size: 16px;">
            <i class="fa-solid fa-th"></i> Question Palette
          </div>
          
          <!-- Question Palette Grid -->
          <div class="question-palette" id="questionPalette"></div>
          
          <!-- Palette Legend -->
          <div class="palette-legend">
            <div class="palette-legend-item">
              <div class="legend-box" style="background: linear-gradient(135deg, #fbbf24, #f59e0b);"></div>
              <span>Current</span>
            </div>
            <div class="palette-legend-item">
              <div class="legend-box" style="background: linear-gradient(135deg, #10b981, #059669);"></div>
              <span>Answered</span>
            </div>
            <div class="palette-legend-item">
              <div class="legend-box" style="background: rgba(255, 255, 255, 0.15); border: 2px solid rgba(255, 255, 255, 0.3);"></div>
              <span>Not Answered</span>
            </div>
            <div class="palette-legend-item">
              <div class="legend-box" style="background: linear-gradient(135deg, #ec4899, #be185d);"></div>
              <span>⭐ Marked</span>
            </div>
          </div>
          
          <!-- Bookmarked Questions (kept for backward compatibility) -->
          <div style="text-align: center; color: white; font-weight: bold; margin: 20px 0 10px; font-size: 14px; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 15px;">
            <i class="fa-solid fa-bookmark"></i> Quick Bookmarks
          </div>
          <div id="bookmarkedQuestions"></div>
        </div>
      </div>

      <div class="supmit disabled">Submit Exam</div>
    </main>

    <div class="popup">
      <div class="popup-ptn">
        <div class="popup-text">Time is over! Exam finished.</div>
        <div class="choose">
          <div class="popup-button">View Results</div>
        </div>
      </div>
    </div>

    <footer>© 2025 Examination System. All rights reserved.</footer>

    <script>
      // Route protection
      if (!localStorage.getItem("currentUserEmail")) {
        location.replace("signin.html");
      }
      
      // Dark Mode Toggle
      const darkModeToggle = document.getElementById("darkModeToggle");
      const body = document.body;
      
      // Check if dark mode was previously enabled
      if (localStorage.getItem("darkMode") === "enabled") {
        body.classList.add("dark-mode");
        darkModeToggle.innerHTML = '<i class="fa-solid fa-sun"></i>';
      }
      
      darkModeToggle.addEventListener("click", () => {
        body.classList.toggle("dark-mode");
        
        if (body.classList.contains("dark-mode")) {
          localStorage.setItem("darkMode", "enabled");
          darkModeToggle.innerHTML = '<i class="fa-solid fa-sun"></i>';
        } else {
          localStorage.setItem("darkMode", "disabled");
          darkModeToggle.innerHTML = '<i class="fa-solid fa-moon"></i>';
        }
      });
      
      // Logout handler
      document.getElementById("logout").addEventListener("click", () => {
        if (confirm("Are you sure you want to logout? Your exam progress will be lost.")) {
          localStorage.removeItem("currentUserEmail");
          sessionStorage.removeItem("examStarted");
          location.replace("index.html");
        }
      });
      
      // Prevent accidental page reload/close
      window.addEventListener("beforeunload", (e) => {
        e.preventDefault();
        e.returnValue = "";
      });
    </script>
    <script src="exam.js"></script>
  </body>
</html>